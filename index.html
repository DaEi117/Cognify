<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Cognify</title>

    <!-- Mobile / iPhone -->
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#2563eb">

    <!-- iOS PWA hints -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Cognify">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="app">
    <header class="topbar card">
        <div class="brand">
            <div class="logo" aria-hidden="true">C</div>
            <div>
                <h1 class="title">Cognify V9.0</h1>
                <div class="subtitle">Minimalistisch. Schnell. Fokus.</div>
            </div>
        </div>

        <div id="navigation" class="nav">
            <button id="btnListen" class="btn btn-primary">Listen verwalten</button>
            <button id="btnAbfrage" class="btn btn-ghost">Abfragen</button>
            <button id="btnStatistik" class="btn btn-ghost">Statistik</button>
        </div>
    </header>

    <!-- ===================== -->
    <!-- Modul 1: Listen -->
    <!-- ===================== -->
    <section id="modulListen" class="stack">

        <div class="card">
            <h2 class="h2">Listen verwalten</h2>

            <h3 class="h3">Neue Liste anlegen</h3>
            <div class="grid">
                <input id="listenName" placeholder="Name der Liste" type="text">
                <input id="feldA" placeholder="Spalte 1" type="text">
                <input id="feldB" placeholder="Spalte 2" type="text">
            </div>
            <button id="listeAnlegen" class="btn btn-primary">Liste anlegen</button>
        </div>

        <div class="card">
            <h3 class="h3">Import</h3>
            <p class="muted">XLSX mit genau zwei Spalten. Erste Zeile = Header (Spaltennamen).</p>
            <button id="btnImportXlsx" class="btn btn-ghost">XLSX importieren (2 Spalten)</button>
            <input id="fileImportXlsx" type="file" accept=".xlsx,.xls" style="display:none">
        </div>

        <div class="card">
            <h3 class="h3">Export</h3>
            <button id="btnExportAllJson" class="btn btn-ghost">Alle Listen exportieren (JSON)</button>
        </div>

        <div class="card">
            <h3 class="h3">Sortieren</h3>
            <p class="muted">Sortiert alle Listen alphabetisch (A–Z). Wird gespeichert.</p>
            <button id="btnSortListenAz" class="btn btn-ghost">Listen A–Z sortieren</button>
        </div>

        <div class="card">
            <h3 class="h3">Gespeicherte Listen</h3>
            <ul id="listenUebersicht" class="list"></ul>

            <div id="eintragsBereich" style="display:none" class="divider-top">
                <h3 id="aktiveListeTitel" class="h3"></h3>

                <div class="grid">
                    <input id="wertA" type="text">
                    <input id="wertB" type="text">
                </div>
                <button id="eintragHinzufuegen" class="btn btn-primary">Eintrag hinzufügen</button>

                <h4 class="h4">Einträge & Statistik</h4>
                <ul id="eintragsListe" class="list"></ul>
            </div>
        </div>

    </section>

    <!-- ===================== -->
    <!-- Modul 2: Abfrage -->
    <!-- ===================== -->
    <section id="modulAbfrage" style="display:none" class="stack">

        <div class="card">
            <h2 class="h2">Abfragen</h2>

            <label class="label">Liste auswählen:</label>
            <select id="abfrageListe"></select>

            <label class="label">Karteikasten-System?</label>
            <select id="karteikastenOption">
                <option value="nein" selected>Nein</option>
                <option value="ja">Ja</option>
            </select>

            <label class="label">Fachauswahl:</label>
            <select id="fachAuswahl" disabled></select>

            <label class="label">Abfragefolge:</label>
            <select id="abfrageFolge">
                <option value="order">Reihenfolge</option>
                <option value="random">Zufall</option>
            </select>

            <label class="label">Abfragerichtung:</label>
            <select id="richtung"></select>

            <label class="label">Anzahl Abfragerunden:</label>
            <select id="runden">
                <option value="all">Gesamte Liste</option>
                <option>10</option><option>20</option><option>30</option>
                <option>40</option><option>50</option>
                <option>60</option><option>70</option><option>80</option>
                <option>90</option><option>100</option>
            </select>

            <div class="startRow">
                <button id="startAbfrage" class="btn btn-primary">Abfrage starten</button>
                <span id="restAnzeige" class="restAnzeige" aria-live="polite"></span>
            </div>
        </div>

        <div id="abfrageBox" style="display:none" class="card quiz">
            <!-- Bild zur Frage -->
            <div id="frageBildWrap" class="imgWrap" style="display:none">
                <img id="frageBild" class="quizImg" alt="Bild zur Frage">
            </div>

            <h3 id="frage" class="question"></h3>

            <p id="loesung" style="display:none" class="solution"></p>

            <!-- Bild zur Antwort (erst nach Prüfen) -->
            <div id="antwortBildWrap" class="imgWrap" style="display:none">
                <img id="antwortBild" class="quizImg" alt="Bild zur Antwort">
            </div>

            <div class="quizActions">
                <button id="btnPruefen" class="btn btn-ghost btn-wide">Prüfen</button>

                <div id="bewertung" style="display:none" class="quizActions">
                    <button id="btnRichtig" class="btn btn-success btn-wide">Richtig</button>
                    <button id="btnFalsch" class="btn btn-danger btn-wide">Falsch</button>
                </div>
            </div>
        </div>

    </section>

    <!-- ===================== -->
    <!-- Modul 3: Statistik -->
    <!-- ===================== -->
    <section id="modulStatistik" style="display:none" class="stack">

        <div class="card">
            <h2 class="h2">Statistik</h2>
            <p class="muted">Übersicht über deinen Lernfortschritt, Fachverteilung und Schwachstellen.</p>

            <div class="statGrid">
                <div class="statCard">
                    <div class="statLabel">Listen</div>
                    <div id="statTotalLists" class="statValue">0</div>
                </div>
                <div class="statCard">
                    <div class="statLabel">Einträge gesamt</div>
                    <div id="statTotalEntries" class="statValue">0</div>
                </div>
                <div class="statCard">
                    <div class="statLabel">Antworten gesamt</div>
                    <div id="statTotalAnswers" class="statValue">0</div>
                </div>
                <div class="statCard">
                    <div class="statLabel">Quote gesamt</div>
                    <div id="statTotalQuote" class="statValue">0%</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3 class="h3">Listenvergleich</h3>
            <p class="muted">Klicke auf einen Spaltenkopf zum Sortieren.</p>

            <div class="tableWrap">
                <table class="table" id="listenVergleichTable" aria-label="Listenvergleich">
                    <thead>
                        <tr>
                            <th data-col="name">Liste</th>
                            <th data-col="entries" class="num">Einträge</th>
                            <th data-col="answers" class="num">Antworten</th>
                            <th data-col="correct" class="num">✔</th>
                            <th data-col="wrong" class="num">✘</th>
                            <th data-col="quote" class="num">Quote</th>
                            <th data-col="fach1" class="num">F1</th>
                            <th data-col="fach2" class="num">F2</th>
                            <th data-col="fach3" class="num">F3</th>
                            <th data-col="fach4" class="num">F4</th>
                            <th data-col="fach5" class="num">F5</th>
                        </tr>
                    </thead>
                    <tbody id="listenVergleichBody"></tbody>
                </table>
            </div>
        </div>

        <div class="card">
            <h3 class="h3">Fachverteilung</h3>

            <label class="label">Anzeige:</label>
            <select id="statListSelect"></select>

            <div class="fachBox">
                <div class="fachRow">
                    <div class="fachLabel">Fach 1</div>
                    <div class="fachBar"><div id="fachBar1" class="fachFill"></div></div>
                    <div id="fachCount1" class="fachCount">0</div>
                </div>
                <div class="fachRow">
                    <div class="fachLabel">Fach 2</div>
                    <div class="fachBar"><div id="fachBar2" class="fachFill"></div></div>
                    <div id="fachCount2" class="fachCount">0</div>
                </div>
                <div class="fachRow">
                    <div class="fachLabel">Fach 3</div>
                    <div class="fachBar"><div id="fachBar3" class="fachFill"></div></div>
                    <div id="fachCount3" class="fachCount">0</div>
                </div>
                <div class="fachRow">
                    <div class="fachLabel">Fach 4</div>
                    <div class="fachBar"><div id="fachBar4" class="fachFill"></div></div>
                    <div id="fachCount4" class="fachCount">0</div>
                </div>
                <div class="fachRow">
                    <div class="fachLabel">Fach 5</div>
                    <div class="fachBar"><div id="fachBar5" class="fachFill"></div></div>
                    <div id="fachCount5" class="fachCount">0</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3 class="h3">Schwachstellen</h3>
            <p class="muted">
                Low Quote: mindestens 5 Antworten &amp; Quote &lt; 60%.<br>
                Top Fehler-Rate: sortiert nach Fehler-Rate (✘ / (✔+✘)).
            </p>

            <div class="weakGrid">
                <div class="weakCol">
                    <h4 class="h4">Top Fehler-Rate</h4>
                    <div class="tableWrap">
                        <table class="table" aria-label="Top Fehler-Rate">
                            <thead>
                                <tr>
                                    <th>Liste</th>
                                    <th>Eintrag</th>
                                    <th class="num">Versuche</th>
                                    <th class="num">✘</th>
                                    <th class="num">Fehler-Rate</th>
                                </tr>
                            </thead>
                            <tbody id="topErrorRateBody"></tbody>
                        </table>
                    </div>
                </div>

                <div class="weakCol">
                    <h4 class="h4">Low Quote</h4>
                    <div class="tableWrap">
                        <table class="table" aria-label="Low Quote">
                            <thead>
                                <tr>
                                    <th>Liste</th>
                                    <th>Eintrag</th>
                                    <th class="num">Versuche</th>
                                    <th class="num">✔</th>
                                    <th class="num">Quote</th>
                                </tr>
                            </thead>
                            <tbody id="lowQuoteBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>

    </section>

</div>

<!-- SheetJS (XLSX Parser + Export) -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<!-- Hidden file input for images (per list) -->
<input id="fileImportImages" type="file" accept=".jpg,.jpeg,.png,image/jpeg,image/png" multiple style="display:none">

<script src="app.js"></script>
</body>
</html>